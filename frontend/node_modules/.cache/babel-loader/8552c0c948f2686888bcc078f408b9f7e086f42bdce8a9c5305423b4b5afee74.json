{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Routes,Route,Navigate,useNavigate,useLocation}from'react-router-dom';import{Toaster}from'react-hot-toast';import{useIsAuthenticated,useMsal}from'@azure/msal-react';import{toast}from'react-hot-toast';// Components\nimport Layout from'./components/Layout';import Login from'./pages/Login';import Dashboard from'./pages/Dashboard';import TableView from'./pages/TableView';// Protected route component\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children}=_ref;const isAuthenticated=useIsAuthenticated();const{instance,accounts}=useMsal();const[loading,setLoading]=useState(true);const navigate=useNavigate();const location=useLocation();useEffect(()=>{console.log('ProtectedRoute - Authentication status:',isAuthenticated);console.log('ProtectedRoute - Accounts:',accounts);console.log('ProtectedRoute - Current location:',location.pathname);// Set a timeout to ensure we don't get stuck in a loading state\nconst timer=setTimeout(()=>{setLoading(false);},2000);return()=>clearTimeout(timer);},[isAuthenticated,accounts,location]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500\"})});}if(!isAuthenticated){console.log('ProtectedRoute - Not authenticated, redirecting to login');toast.error('Please log in to access this page');return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}console.log('ProtectedRoute - Authenticated, rendering children');return children;};function App(){const isAuthenticated=useIsAuthenticated();const{instance,accounts}=useMsal();const navigate=useNavigate();const location=useLocation();useEffect(()=>{console.log('App - Authentication status:',isAuthenticated);console.log('App - Accounts:',accounts);console.log('App - Current location:',location.pathname);// Handle redirect response if we're coming back from a redirect flow\nif(location.hash&&location.hash.includes('access_token')){console.log('App - Detected authentication response in URL hash');instance.handleRedirectPromise().then(response=>{console.log('App - Redirect response processed successfully:',response);if(response){toast.success('Successfully logged in!');navigate('/');}}).catch(error=>{console.error('App - Error processing redirect:',error);toast.error(\"Authentication error: \".concat(error.message));});}},[isAuthenticated,accounts,location,instance,navigate]);return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(Toaster,{position:\"top-right\"}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsx(Dashboard,{})})})}),/*#__PURE__*/_jsx(Route,{path:\"/table/:tableName\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsx(TableView,{})})})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})})]})]});}export default App;","map":{"version":3,"names":["React","useEffect","useState","Routes","Route","Navigate","useNavigate","useLocation","Toaster","useIsAuthenticated","useMsal","toast","Layout","Login","Dashboard","TableView","jsx","_jsx","jsxs","_jsxs","ProtectedRoute","_ref","children","isAuthenticated","instance","accounts","loading","setLoading","navigate","location","console","log","pathname","timer","setTimeout","clearTimeout","className","error","to","replace","App","hash","includes","handleRedirectPromise","then","response","success","catch","concat","message","position","path","element"],"sources":["/Users/robertobutinar/codebase/data_entry_app/frontend/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Routes, Route, Navigate, useNavigate, useLocation } from 'react-router-dom';\nimport { Toaster } from 'react-hot-toast';\nimport { useIsAuthenticated, useMsal } from '@azure/msal-react';\nimport { toast } from 'react-hot-toast';\n\n// Components\nimport Layout from './components/Layout';\nimport Login from './pages/Login';\nimport Dashboard from './pages/Dashboard';\nimport TableView from './pages/TableView';\n\n// Protected route component\nconst ProtectedRoute = ({ children }) => {\n  const isAuthenticated = useIsAuthenticated();\n  const { instance, accounts } = useMsal();\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  const location = useLocation();\n  \n  useEffect(() => {\n    console.log('ProtectedRoute - Authentication status:', isAuthenticated);\n    console.log('ProtectedRoute - Accounts:', accounts);\n    console.log('ProtectedRoute - Current location:', location.pathname);\n    \n    // Set a timeout to ensure we don't get stuck in a loading state\n    const timer = setTimeout(() => {\n      setLoading(false);\n    }, 2000);\n    \n    return () => clearTimeout(timer);\n  }, [isAuthenticated, accounts, location]);\n  \n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500\"></div>\n      </div>\n    );\n  }\n  \n  if (!isAuthenticated) {\n    console.log('ProtectedRoute - Not authenticated, redirecting to login');\n    toast.error('Please log in to access this page');\n    return <Navigate to=\"/login\" replace />;\n  }\n  \n  console.log('ProtectedRoute - Authenticated, rendering children');\n  return children;\n};\n\nfunction App() {\n  const isAuthenticated = useIsAuthenticated();\n  const { instance, accounts } = useMsal();\n  const navigate = useNavigate();\n  const location = useLocation();\n  \n  useEffect(() => {\n    console.log('App - Authentication status:', isAuthenticated);\n    console.log('App - Accounts:', accounts);\n    console.log('App - Current location:', location.pathname);\n    \n    // Handle redirect response if we're coming back from a redirect flow\n    if (location.hash && location.hash.includes('access_token')) {\n      console.log('App - Detected authentication response in URL hash');\n      instance.handleRedirectPromise()\n        .then(response => {\n          console.log('App - Redirect response processed successfully:', response);\n          if (response) {\n            toast.success('Successfully logged in!');\n            navigate('/');\n          }\n        })\n        .catch(error => {\n          console.error('App - Error processing redirect:', error);\n          toast.error(`Authentication error: ${error.message}`);\n        });\n    }\n  }, [isAuthenticated, accounts, location, instance, navigate]);\n  \n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <Toaster position=\"top-right\" />\n      <Routes>\n        <Route path=\"/login\" element={<Login />} />\n        <Route path=\"/\" element={\n          <ProtectedRoute>\n            <Layout>\n              <Dashboard />\n            </Layout>\n          </ProtectedRoute>\n        } />\n        <Route path=\"/table/:tableName\" element={\n          <ProtectedRoute>\n            <Layout>\n              <TableView />\n            </Layout>\n          </ProtectedRoute>\n        } />\n        <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n      </Routes>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}