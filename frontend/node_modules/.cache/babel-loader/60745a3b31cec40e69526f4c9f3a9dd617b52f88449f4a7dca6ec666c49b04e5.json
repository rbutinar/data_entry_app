{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate,useLocation}from'react-router-dom';import{useMsal,useIsAuthenticated}from'@azure/msal-react';import{loginRequest}from'../authConfig';import{toast}from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Login=()=>{const{instance,accounts}=useMsal();const isAuthenticated=useIsAuthenticated();const navigate=useNavigate();const location=useLocation();const[loginError,setLoginError]=useState(null);const[processing,setProcessing]=useState(false);useEffect(()=>{console.log('Login - Authentication status:',isAuthenticated);console.log('Login - Accounts:',accounts);console.log('Login - Current location:',location);// Check if we're coming back from a redirect\nif(location.hash&&location.hash.includes('access_token')){console.log('Login - Detected authentication response in URL hash');setProcessing(true);instance.handleRedirectPromise().then(response=>{console.log('Login - Redirect response processed:',response);if(response){toast.success('Successfully logged in!');navigate('/');}}).catch(error=>{console.error('Login - Error processing redirect:',error);setLoginError(\"Authentication error: \".concat(error.message));}).finally(()=>{setProcessing(false);});}// If already authenticated, navigate to home\nif(isAuthenticated&&accounts.length>0){console.log('Login - User is authenticated, navigating to home');navigate('/');}},[isAuthenticated,navigate,accounts,instance,location]);const handleLogin=()=>{console.log('Login - Login button clicked');console.log('Login - MSAL config:',instance.config);setProcessing(true);try{// Use redirect flow\ninstance.loginRedirect(loginRequest).catch(error=>{console.error('Login - Login redirect failed:',error);setLoginError(error.message);setProcessing(false);});}catch(error){console.error('Login - Exception during login attempt:',error);setLoginError(error.message);setProcessing(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-md w-full space-y-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mt-6 text-center text-3xl font-extrabold text-gray-900\",children:\"Data Entry Application\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-center text-sm text-gray-600\",children:\"Sign in with your Azure AD account to access the application\"})]}),processing?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center mt-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500 mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Processing authentication...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[loginError&&/*#__PURE__*/_jsx(\"div\",{className:\"rounded-md bg-red-50 p-4 mt-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"ml-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-red-800\",children:\"Login Error\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-sm text-red-700\",children:/*#__PURE__*/_jsx(\"p\",{children:loginError})})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 space-y-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleLogin,className:\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\",disabled:processing,children:\"Sign in with Microsoft\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"After clicking sign in, you'll be redirected to the Microsoft login page.\"})})]})]})]})});};export default Login;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useLocation","useMsal","useIsAuthenticated","loginRequest","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Login","instance","accounts","isAuthenticated","navigate","location","loginError","setLoginError","processing","setProcessing","console","log","hash","includes","handleRedirectPromise","then","response","success","catch","error","concat","message","finally","length","handleLogin","config","loginRedirect","className","children","onClick","disabled"],"sources":["/Users/robertobutinar/codebase/data_entry_app/frontend/src/pages/Login.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useMsal, useIsAuthenticated } from '@azure/msal-react';\nimport { loginRequest } from '../authConfig';\nimport { toast } from 'react-hot-toast';\n\nconst Login = () => {\n  const { instance, accounts } = useMsal();\n  const isAuthenticated = useIsAuthenticated();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [loginError, setLoginError] = useState(null);\n  const [processing, setProcessing] = useState(false);\n  \n  useEffect(() => {\n    console.log('Login - Authentication status:', isAuthenticated);\n    console.log('Login - Accounts:', accounts);\n    console.log('Login - Current location:', location);\n    \n    // Check if we're coming back from a redirect\n    if (location.hash && location.hash.includes('access_token')) {\n      console.log('Login - Detected authentication response in URL hash');\n      setProcessing(true);\n      \n      instance.handleRedirectPromise()\n        .then(response => {\n          console.log('Login - Redirect response processed:', response);\n          if (response) {\n            toast.success('Successfully logged in!');\n            navigate('/');\n          }\n        })\n        .catch(error => {\n          console.error('Login - Error processing redirect:', error);\n          setLoginError(`Authentication error: ${error.message}`);\n        })\n        .finally(() => {\n          setProcessing(false);\n        });\n    }\n    \n    // If already authenticated, navigate to home\n    if (isAuthenticated && accounts.length > 0) {\n      console.log('Login - User is authenticated, navigating to home');\n      navigate('/');\n    }\n  }, [isAuthenticated, navigate, accounts, instance, location]);\n  \n  const handleLogin = () => {\n    console.log('Login - Login button clicked');\n    console.log('Login - MSAL config:', instance.config);\n    setProcessing(true);\n    \n    try {\n      // Use redirect flow\n      instance.loginRedirect(loginRequest)\n        .catch(error => {\n          console.error('Login - Login redirect failed:', error);\n          setLoginError(error.message);\n          setProcessing(false);\n        });\n    } catch (error) {\n      console.error('Login - Exception during login attempt:', error);\n      setLoginError(error.message);\n      setProcessing(false);\n    }\n  };\n  \n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div>\n          <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900\">\n            Data Entry Application\n          </h2>\n          <p className=\"mt-2 text-center text-sm text-gray-600\">\n            Sign in with your Azure AD account to access the application\n          </p>\n        </div>\n        \n        {processing ? (\n          <div className=\"flex flex-col items-center justify-center mt-8\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500 mb-4\"></div>\n            <p className=\"text-gray-600\">Processing authentication...</p>\n          </div>\n        ) : (\n          <>\n            {loginError && (\n              <div className=\"rounded-md bg-red-50 p-4 mt-4\">\n                <div className=\"flex\">\n                  <div className=\"ml-3\">\n                    <h3 className=\"text-sm font-medium text-red-800\">Login Error</h3>\n                    <div className=\"mt-2 text-sm text-red-700\">\n                      <p>{loginError}</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n            <div className=\"mt-8 space-y-6\">\n              <button\n                onClick={handleLogin}\n                className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n                disabled={processing}\n              >\n                Sign in with Microsoft\n              </button>\n              <div className=\"text-center mt-4\">\n                <p className=\"text-sm text-gray-600\">\n                  After clicking sign in, you'll be redirected to the Microsoft login page.\n                </p>\n              </div>\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}